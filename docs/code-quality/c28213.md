---
description: "Learn more about: Warning C28213"
title: Warning C28213
ms.date: 02/07/2023
f1_keywords: ["C28213", "BAD_USEHEADER", "__WARNING_BAD_USEHEADER"]
helpviewer_keywords: ["C28213"]
---
# Warning C28213

> The `_Use_decl_annotations_` annotation must be used to reference, without modification, a prior declaration.

## Remarks

`_Use_decl_annotations_` tells the compiler to use the annotations from an earlier declaration of the function. If no earlier declaration can be found, or if the current declaration makes changes to the annotations, then this warning is emitted. `_Use_decl_annotations_` also allows removing all other annotations from the definition and will use the declaration annotations for analysis of the function.

This diagnostic is frequently a side effect of refactoring or fixing other warnings by adjusting the annotations on a function. If this is the case then to fix the issue, the 'correct' set of annotations needs to replace the annotations at the other locations. To determine the correct set of annotations, look at the behavior in the function definition. In most cases this behavior is intended and should be reflected in the annotations to the function. Refer to the guide on [Using SAL Annotations to reduce code defects](using-sal-annotations-to-reduce-c-cpp-code-defects.md) for more information on SAL.

It is important for the annotations to match between the declarations and the definition of a function. When analyzing the call site of the function the declaration annotations are used, so when the declaration and definition do not match it leads to incorrect results from the static analysis tools. When fixing this warning, it is common for it to have cascading effects as the tool reanalyzes the source with updated information.

If this diagnostic is a result of no previous declaration being found in the translation unit then there is most likely a missing `#include`.  If the header file is intentionally not included then to resolve this issue you can verify the the annotations in the declaration and definition match and remove `_Use_decl_annotations_`. Be careful when doing this as the two sets of annotations may get out of sync in the future.

Code analysis name: BAD_USEHEADER

## Examples

The following code generates C28160. The `buffer` parameter annotation doesn't match between the two files.

*From example.h:*

```cpp
void example_func(_Out_writes_(n) char* buffer, int n);
```

*From example.cpp:*

```cpp
_Use_decl_annotations_
void example_func(_Out_writes_z_(n) char* buffer, int n)
{
    buffer[n] = '\0';
}
```

This issue can be fixed by either changing the annotation so they match at all locations, or by removing all annotations except `_Use_decl_annotations_` from the function definition after verifying the declaration annotations are correct. In this simple example, `_Out_writes_z_` appears to be correct so we'll move that annotation to the function declaration in the header file. We will also remove all other annotations from the definition to simplify future maintenance although this is optional.

In real world code it is usually not as clear which annotation is correct, consult with the documentation on [using SAL Annotations to reduce code defects](using-sal-annotations-to-reduce-c-cpp-code-defects.md) for additional guidance.

*From example.h:*

```cpp
void example_func(_Out_writes_z_(n) char* buffer, int n);
```

*From example.cpp:*

```cpp
_Use_decl_annotations_
void example_func(char* buffer, int n)
{
    buffer[n] = '\0';
}
```

## See also

[Rule sets for C++ code](./using-rule-sets-to-specify-the-cpp-rules-to-run.md)\
[Using SAL Annotations to reduce code defects](using-sal-annotations-to-reduce-c-cpp-code-defects.md)\
[C28252](C28252.md)\
[C28253](C28253.md)\
[C28301](C28301.md)
